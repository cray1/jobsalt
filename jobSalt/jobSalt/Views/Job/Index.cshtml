@{
    ViewBag.Title = "Home Page";
}


 <div class="container">
    <div class="jumbotron">
        @Html.Partial("_FilterPartial")
        <h1>Job Search</h1>
        @using jobSalt.Models;
        @using (Ajax.BeginForm("AssignFilter", "FilterUtility", new AjaxOptions() { OnSuccess = "resetJobs();" }))
        {
           <input id="value" name="value" type="text" value="@FilterUtility.GetFilterValue(Field.Keyword)">
           <input type="submit" value="Search"/>
            <input type="hidden" id="targetField" name="targetField" value="Keyword" />
        }
    </div>
     <div id="productList"></div>

     <div id="loading"></div> 
</div>

    @section Scripts
{
        <script type="text/javascript">

            var page = 0;
            var _inCallback = false;

            $(window).load(function () {
                loadJobs();
            });

            function resetJobs() {
                page = 0;
                _inCallback = false;
                $("#productList").empty();

                loadJobs();
            }

            function loadJobs() {
                if (page > -1 && !_inCallback) {
                    _inCallback = true;

                    $('div#loading').html('<p><img src="/Content/images/loading.gif"></p>');
                    $.get("/Job/Index?page=" + page, function (data) {
                        if (data != '') {
                            $("#productList").append(data);
                        }
                        else {
                            page = -1;
                        }

                        _inCallback = false;
                        $('div#loading').empty();
                    });
                    page++;
                }
            }

            var dcList = true;

            $(window).scroll(function () {
                if ($(window).scrollTop() == $(document).height() - $(window).height()) {

                    loadProducts();
                }
            });
        </script>
    }
